{
  auto_https off
}

# short domain (http-only on :8550)
http://{$SHORT_DOMAIN}:8550 {
  log {
    output stdout
    format console
  }

  @shorten path /shorten
  handle @shorten {
    header {
      Access-Control-Allow-Origin https://{$PASTE_DOMAIN}
      Access-Control-Allow-Methods GET, OPTIONS
      Access-Control-Allow-Headers *
      Cache-Control no-store
    }
    reverse_proxy http://shlink-adapter:3000
  }

  @shortenPre method OPTIONS path /shorten
  respond @shortenPre 204

  # everything else â†’ shlink ui/api
  handle {
    reverse_proxy http://shlink:8080
  }
}

# paste domain (http-only)
http://{$PASTE_DOMAIN}:8550 {
  reverse_proxy http://privatebin:8080
}

# files domain (http-only)
http://{$FILES_DOMAIN}:8550 {
  reverse_proxy http://lufi:8081
}

http://{$HOME_DOMAIN}:8550 {
	root * /var/www/share
	file_server
} 
